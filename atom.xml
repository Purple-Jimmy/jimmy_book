<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[jimmy_codebook]]></title>
  <link href="https://purple-jimmy.github.io/jimmy_book/atom.xml" rel="self"/>
  <link href="https://purple-jimmy.github.io/jimmy_book/"/>
  <updated>2018-10-14T21:20:10+08:00</updated>
  <id>https://purple-jimmy.github.io/jimmy_book/</id>
  <author>
    <name><![CDATA[]]></name>
    
  </author>
  <generator uri="http://www.mweb.im/">MWeb</generator>
  
  <entry>
    <title type="html"><![CDATA[日志管理]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/nginx%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86.html"/>
    <updated>2018-10-19T22:45:48+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/nginx%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86.html</id>
    <content type="html"><![CDATA[
<p>nginx允许对不同的server做不同的log</p>

<h2 id="toc_0">nginx的server段有如下配置</h2>

<pre><code class="language-text">#access_log  logs/host.access.log  main;
</code></pre>

<p>access_log:声明日志<br/>
logs/host.access.log:server的访问日志的文件路径<br/>
main:使用的日志格式</p>

<h2 id="toc_1">main格式日志</h2>

<pre><code class="language-text">#log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;
    #                  &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;
    #                  &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;
    
$remote_addr:远程IP
$remote_user:远程用户
$time_local:用户触发访问时间
$request:访问方式(get,post等)
$status:相应状态
$body_bytes_sent:请求体body长度
$http_referer:来源信息
$http_user_agent:用户代理,被转发的请求的原始IP
$http_x_forwarded_for:在经过代理时,代理把你原始的IP放在此头信息中并传输
</code></pre>

<h2 id="toc_2">自定义日志格式</h2>

<pre><code class="language-text">log_format custom_log &#39;$remote_addr&#39;;
</code></pre>

<h2 id="toc_3">日志切割</h2>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[虚拟主机配置]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/nginx%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE.html"/>
    <updated>2018-10-17T22:55:38+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/nginx%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE.html</id>
    <content type="html"><![CDATA[
<p>nginx配置段</p>

<pre><code class="language-text">//全局区
worker_processes  1;//子进程数量,一般设置cpu*core数

//配置nginx的连接特性
events{
  worker_connections  1024;//一个子进程最大允许1024个连接
}

//配置http服务器的主要段
http{
  server{//虚拟主机段
    location{//定位,把特殊的路径或文件再次定位,如image目录单独处理
    }
  }
}
</code></pre>

<h2 id="toc_0">基于域名的虚拟主机</h2>

<h2 id="toc_1">基于端口的虚拟主机</h2>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[信号量控制]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/%E4%BF%A1%E5%8F%B7%E6%8E%A7%E5%88%B6.html"/>
    <updated>2018-10-16T23:17:59+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/%E4%BF%A1%E5%8F%B7%E6%8E%A7%E5%88%B6.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[介绍]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/nginx%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85.html"/>
    <updated>2018-10-14T19:55:24+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/nginx%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85.html</id>
    <content type="html"><![CDATA[
<ul>
<li>高性能web服务器</li>
<li>http和反向代理服务器,也是IMAP、POP3、SMTP代理服务器</li>
</ul>

<h1 id="toc_0">安装</h1>

<pre><code class="language-text">1. mkdir jimmy
2. cd /jimmy
3. wget http://nginx.org/download/nginx-1.14.0.tar.gz
4. tar -zxvf nginx-1.14.0.tar.gz
5. yum -y install gcc zlib zlib-devel pcre-devel openssl openssl-devel
6. make &amp;&amp; make install
</code></pre>

<h1 id="toc_1">常用命令</h1>

<p>启动停止</p>

<pre><code class="language-text">cd cd /usr/local/nginx
1. 测试: ./sbin/nginx -t
2. 启动: ./sbin/nginx
3. 停止: ./sbin/nginx -s stop 或者 nginx -s quit 
4. 重启: ./sbin/nginx -s reload
5. 日志切割: ./sbin/nginx -s reopen
</code></pre>

<p>平滑重启</p>

<pre><code class="language-text">kill -HUP `cat logs/nginx.pid`  
</code></pre>

<p>查看进程</p>

<pre><code class="language-text">ps -ef | grep nginx
</code></pre>

<p>查看端口-服务关系</p>

<pre><code class="language-text">netstat -antp
</code></pre>

<p>配置防火墙</p>

<pre><code class="language-text">1. 开启端口 firewall-cmd --zone=public --add-port=80/tcp --permanent      
2. 重启防火墙  firewall-cmd --reload  
3. 查看端口 firewall-cmd --query-port=80/tcp

</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[bool]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/bool.html"/>
    <updated>2018-09-25T22:46:06+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/bool.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[constant_score]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/constant_score.html"/>
    <updated>2018-09-25T22:45:24+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/constant_score.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[复合查询概念]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/%E5%A4%8D%E5%90%88%E6%9F%A5%E8%AF%A2%E6%A6%82%E5%BF%B5.html"/>
    <updated>2018-09-25T22:45:07+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/%E5%A4%8D%E5%90%88%E6%9F%A5%E8%AF%A2%E6%A6%82%E5%BF%B5.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ids]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/ids.html"/>
    <updated>2018-09-25T22:43:54+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/ids.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[type]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/type.html"/>
    <updated>2018-09-25T22:43:39+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/type.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[fuzzy 模糊查询]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/fuzzy.html"/>
    <updated>2018-09-25T22:43:06+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/fuzzy.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[regexp 正则查询]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/regexp.html"/>
    <updated>2018-09-25T22:42:33+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/regexp.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[wildcard 通配符查询]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/wildcard.html"/>
    <updated>2018-09-25T22:41:22+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/wildcard.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[exists]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/exists.html"/>
    <updated>2018-09-25T22:40:38+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/exists.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[prefix]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/prefix.html"/>
    <updated>2018-09-25T22:40:22+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/prefix.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[range]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/range.html"/>
    <updated>2018-09-25T22:40:06+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/range.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[terms]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/terms.html"/>
    <updated>2018-09-25T22:29:52+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/terms.html</id>
    <content type="html"><![CDATA[
<p>查询文档中包含任一个给定多词项的文档</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[term 单个值精确搜索]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/term.html"/>
    <updated>2018-09-25T22:29:11+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/term.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">keyword 类型</h2>

<p>查询值不会被分词,只有当查询词和检索字段的keyword完全一致时才能被检索出来</p>

<pre><code class="language-text">curl -H &quot;Content-Type:application/json&quot; -X GET &#39;localhost:9200/es/blog/_search?pretty&#39; -d &#39;
{
  &quot;query&quot;: {
       &quot;term&quot;:{
           &quot;title.keyword&quot;:&quot;Elasticsearch Tutorial&quot;
       }
  },
  &quot;_source&quot;:[&quot;title&quot;]
}
&#39;
</code></pre>

<p>结果</p>

<pre><code class="language-text">&quot;hits&quot; : {
    &quot;total&quot; : 1,
    &quot;max_score&quot; : 0.6931472,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;es&quot;,
        &quot;_type&quot; : &quot;blog&quot;,
        &quot;_id&quot; : &quot;7&quot;,
        &quot;_score&quot; : 0.6931472,
        &quot;_source&quot; : {
          &quot;title&quot; : &quot;Elasticsearch Tutorial&quot;
        }
      }
    ]
  }
</code></pre>

<h2 id="toc_1">text 类型</h2>

<pre><code class="language-text">curl -XGET &quot;http://localhost:9200/tutorial_book/book/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;
{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;bookName&quot;: &quot;java编程思想&quot;
    }
  }
}&#39;
</code></pre>

<p>结果查询不到数据</p>

<hr/>

<pre><code class="language-text">curl -XGET &quot;http://localhost:9200/tutorial_book/book/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;
{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;bookName&quot;: &quot;编&quot;
    }
  }
}&#39;
</code></pre>

<p>结果</p>

<pre><code class="language-text">java编程思想
</code></pre>

<hr/>

<pre><code class="language-text">curl -XGET &quot;http://localhost:9200/tutorial_book/book/_search&quot; -H &#39;Content-Type: application/json&#39; -d&#39;
{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;bookName&quot;: &quot;java&quot;
    }
  }
}&#39;
</code></pre>

<p>结果</p>

<pre><code class="language-text">Java
java编程思想
</code></pre>

<p>原因:term查询时传入的查询值不会被分词,而text类型会被默认的标准分析器分词成如下的词.所以传入的<em><u>java编程思想</u></em>没有与之匹配的词因此检索不到数据</p>

<h2 id="toc_2">查看分词</h2>

<pre><code class="language-text">curl  -H &quot;Content-Type:application/json&quot; -XGET &quot;localhost:9200/_analyze?pretty&quot; -d&#39;
{
  &quot;analyzer&quot;: &quot;standard&quot;,
  &quot;text&quot;:     &quot;java编程思想&quot;
}‘

----------------------
{
  &quot;tokens&quot;: [
    {
      &quot;token&quot;: &quot;java&quot;,
      &quot;start_offset&quot;: 0,
      &quot;end_offset&quot;: 4,
      &quot;type&quot;: &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot;: 0
    },
    {
      &quot;token&quot;: &quot;编&quot;,
      &quot;start_offset&quot;: 4,
      &quot;end_offset&quot;: 5,
      &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot;: 1
    },
    {
      &quot;token&quot;: &quot;程&quot;,
      &quot;start_offset&quot;: 5,
      &quot;end_offset&quot;: 6,
      &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot;: 2
    },
    {
      &quot;token&quot;: &quot;思&quot;,
      &quot;start_offset&quot;: 6,
      &quot;end_offset&quot;: 7,
      &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot;: 3
    },
    {
      &quot;token&quot;: &quot;想&quot;,
      &quot;start_offset&quot;: 7,
      &quot;end_offset&quot;: 8,
      &quot;type&quot;: &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot;: 4
    }
  ]
}
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[词项查询]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/%E8%AF%8D%E9%A1%B9%E6%9F%A5%E8%AF%A2%E6%A6%82%E5%BF%B5.html"/>
    <updated>2018-09-25T22:25:45+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/%E8%AF%8D%E9%A1%B9%E6%9F%A5%E8%AF%A2%E6%A6%82%E5%BF%B5.html</id>
    <content type="html"><![CDATA[
<p>全文查询将在执行之前分析查询字符串,但词项级别查询将按照存储在倒排索引中的词项进行精确操作.<br/>
这些查询通常用于数字,日期和枚举等结构化数据,而不是全文本字段.或者,它们允许您制作低级查询,并在分析过程之前进行.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[simple_query_string]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/15378854080366.html"/>
    <updated>2018-09-25T22:23:28+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/15378854080366.html</id>
    <content type="html"><![CDATA[
<p>解析出错时不抛异常,丢弃查询无效的部分</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[query_string]]></title>
    <link href="https://purple-jimmy.github.io/jimmy_book/query_string.html"/>
    <updated>2018-09-25T22:23:06+08:00</updated>
    <id>https://purple-jimmy.github.io/jimmy_book/query_string.html</id>
    <content type="html"><![CDATA[

]]></content>
  </entry>
  
</feed>
